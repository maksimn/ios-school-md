# JS. Типы, значения и переменные.

## 3.1. Числовой тип.

В JavaScript все числа являются числами с плавающей точкой, занимающими 8 байт. Отдельного целочисленного типа нет. Число, написанное в программе в явном виде, называется числовым литералом. Его можно записать в виде 10-тичного или 16-тиричного числа (8-ричное представление лучше не пытаться использовать – оно не соответствует стандарту).

### Арифметические операции в JS

`+, -, *, /`,  а также методы класса `Math`.

Ошибки при арифметических операциях

```
5 / 0 = Infinity     -5 / 0 = -Infinity
0 / 0 = NaN     Infinity / Infinity = NaN     Math.sqrt(-3) = NaN
```

`Infinity` и `NaN` – предопределенные глобальные переменные JS.

Особенность: `NaN != NaN`

Как у всех языков с бинарным представлением вещественных чисел, в JS есть проблемы с ошибками округления.

### Объект Number

Имеет члены:

```js
Number.POSITIVE_INFINITY, 
Number.NEGATIVE_INFINITY, 
Number.NaN,
Number.MAX_VALUE, 
Number.MIN_VALUE.
```

### 3.5. Объект global


Это обычный объект JavaScript, свойства которого являются глобально определёнными символами (именами?), доступными всей JS-программе. Эти свойства включают

* глобальные свойства типа `undefined, Infinity, NaN`
* глобальные функции типа `isNaN(), parseInt(), eval()`
* функции-конструкторы типа `Date(), RegExp(), String(), Object(), Array()`
* глобальные объекты типа `Math` и `JSON`

В коде верхнего уровня ключевое слово `this` может использоваться как ссылка на этот глобальный объект. 

В клиентском JavaScript объект `Window` служит в качестве глобального объекта для всего кода JS, содержащегося в окне браузера, которое он представляет. Этот глобальный объект `Window` имеет ссылающееся на самого себя свойство `window`, которое может использоваться вместо `this` для того, чтобы сослаться на глобальный объект. 

Объект `Window` определяет данные базовые глобальные свойства, и он также определяет относительно небольшое количество других глобальных имён, специфичных для веб-браузера и клиентского JS.

Глобальный объект также содержит определяемые программистом глобальные переменные как свои свойства.

### 3.6. Объекты-wrapper'ы

Строки JS являются примитивными типами, а не объектами, но почему они имеют свойства? 

Каждый раз, когда вы пытаетесь сослаться на свойство строки `s`, JavaScript преобразует строковое значение в объект, как будто вызывая `new String(s)`. Этот объект наследует методы строк и используется для того, чтобы определить ссылку на свойство. После определения свойства созданный объект отбрасывается. Имеются подобные объекты для булевого и численного типа.

Эти временные объекты называются объектами-wrapper'ами. Их можно создавать в явном виде через конструкторы, но это редко когда нужно.

### 3.10. Область видимости переменной

Область видимости переменной – это область исходного кода вашей программы, в которой она определена. 

Глобальная переменная имеет глобальную область видимости. Локальные переменные и параметры функции локализованы в их функции. В пределах функции имена локальных переменных имеют приоритет над глобальными.

Определения функций могут быть вложенными. Каждая функция имеет свою собственную локальную область видимости, поэтому возможно иметь несколько вложенных уровней локальных областей видимости.

__1. Функциональная область видимости и повышение (hoisting)__

В некоторых C-подобных языках программирования каждый блок кода в фигурных скобках имеет собственную область видимости, и переменные не видны за пределами данного блока, в котором они объявлены. Это называется __блочной областью видимости__, и в JS её не имеется.

JS характеризуется __функциональной областью видимости__: переменные, определённые внутри функции, видны в пределах всей функции (включая вложенные функции), но не существуют вне этой функции. 

Функциональная область видимости в JS означает, что все переменные, объявленные в функции, видимы во всём теле функции полностью, от начала и до конца. Т. е. они видны даже до того, как объявлены. Неформально это свойство JS называется __"повышением" (hoisting)__ – JS код ведёт себя так, как если бы все объявления переменных (но не связанные с ними присваивания) были бы подняты на самый верх функции.

__2. Переменные как свойства__

Глобальные переменные являются свойствами глобального объекта. В зависимости от способа их определения их можно сделать неудаляемыми с помощью оператора `delete` или удаляемыми.

Локальные переменные можно представить как свойства объекта, связанного с каждым вызовом функции. Функционирование данного объекта является вопросом реализации. Он важен для реализации цепочки областей видимости (т. е. замыканий).

__3. Цепочка областей видимости__

JavaScript – язык с лексической областью видимости: область видимости переменной можно представить как набор строк кода, для которых переменная определена.

Глобальные переменные определены во всей программе. Локальные переменные определены во всей функции, в которой они объявлены, а также в функциях, которые вложены в эту функцию.

Если представить локальные переменные как свойства некоторого объекта реализации, то есть и другой способ представить область видимости переменной. Каждый кусок кода JS (глобального кода или кода функций) имеет цепочку областей видимости, связанную с ним. Это список или цепь объектов, которая определяет переменные, которые являются видимыми для этого кода. Когда JS нужно найти переменную `x` (процесс называется разрешением переменной), он начинается с просмотра первого объекта в цепочке. Если этот объект имеет свойство по имени `x`, то используется значение этого свойства. Если первый объект не имеет свойства с именем `x`, JS продолжает поиск со следующего объекта в данной цепочке. Если второй объект не имеет объекта с именем `x`, поиск переходит к следующему объекту, и так далее. Если `x` не является свойством какого-либо из объектов в цепочке областей видимости, то `x` не является видимым для данного кода, и происходит `ReferenceError`.

В коде верхнего уровня (т. е. коде, не находящимся внутри определений какой-либо функции), цепочка областей видимости состоит из единственного объекта – глобального объекта. В невложенной функции цепочка состоит из двух объектов – объекта, содержащего параметры функции и локальные переменные, и глобального объекта. Во вложенной функции цепочка состоит их трёх или более объектов. 

Важно понимать, как эта цепочка объектов создаётся. Когда функция определяется, она хранит действующую цепочку областей видимости. Когда эта функция вызывается, она создаёт новый объект для хранения локальных переменных, и добавляет этот новый объект к хранимой цепочке областей видимости для образования новой, более длинной цепочки, которая представляет область видимости для вызова этой функции. Это становится более интересным для вложенных функций, потому что каждый раз, когда вызывается внешняя функция, внутренняя функция определяется снова. Поскольку область видимости отличается для каждого вызова внешней функции, внутренняя функция будет немного отличаться всякий раз, когда она определяется – код внутренней функции будет идентичным при каждом вызове внешней функции, но цепочка областей видимости, связанная с этим кодом, будет другой.

Понятие о цепочке областей видимости полезно для понимания Выражения `with` и является критическим для понимания _замыканий_.
