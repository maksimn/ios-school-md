# REST

__Progressive Disclosure__ – понятие в проектировании пользовательского интерфейса, в котором идея заключается в том, чтобы предоставлять пользователю нужную ему информацию только по мере её необходимости.

## Введение

REST нужен для того, чтобы создать систему, адаптивную к изменениям.

Есть 2 основные проблемы – дубликация усилий и избегание гипермедиа.

__Дубликация усилий__

Смысл в том, что все API (например, Google+ API, Facebook API, Twitter API) совершенно непохожи друг на друга, хотя делают по сути одно и то же.

Нужно разбить эту задачу на осмысленные части, чем писать новый, 58-ой API для микроблоггинга с нуля.

__Гипермедиа – сложный предмет__

В этой книге объясняется то, как работает гипермедиа. Даже если вы раньше не слышали это слово. Гипермедиа – отдельный и самый важный аспект REST.

---

__REST__ - архитектурный стиль, позволяющий сделать сетевое взаимодействие удобнее, прозрачнее и стандартизированнее. 

Пример взаимодействия приложений 

```
github.com 
  |
github api 
  |
waffIe.io сервис, позволяющий более удобно работать с github-задачами (issues) 
```

```js
repo.createIssue(title, description)  
//   method +    arguments
```

Это создание задачи в репозитории, но его нужно сделать УДАЛЕННО 

## Способы удалённого вызова 

__RPC__ (Remote Procedure Call) 

удаленный вызов процедуры может быть сделан на основе разных форматов, ХМL, JSON. 

```
// request, напр. НТТР 
{ 
  "jsonrpc": 2.0", // спецификация для удалённых вызовов м/у сервером и клиентом 
  "id": 1, // идентифицирует запрос, для их различения 
  "method": "createlssue", 
  "params": [tit1e, descripton] 
} 

// response от сервера, метод вызван, сообщение о результате 
{ 
  "jsonrpc": "2.0", 
  "id": 1, 
  "result": "0k" /* "error": ... */ 
}
```

RPC имеет некоторые ограничения 

__REST__ - другой подход. 

```
РОSТ /issue HTTP/1.1 
Host: github.com 

{ 
  "title": "Add js linter", 
  "description": "eslint" 
} 
```

Ответ:

```
HTTP/1.1 201 Created 
Location: /issue/42 
```

__REST vs RPC__ 

RPC опирается на методы (действия) 

REST - на ресурсы (объекты, сущности) 

RPC использует НТТР только как транспорт 

REST - базируется на НТТР и расширяет его 

## REST
 
1) Система должна быть разделена на клиента и сервера, у каждого задан формат запроса. 
2) Stateless 
3) Кэшируемость 
4) Layered - запросы клиента может обслуживать не 1 сервер, а несколько. 
5) Uniform interface - АРI сервера должно быть единообразным, построенным на единых правилах.

Представительная передача состояния. 

Набор правил, как передавать состояние между клиентом и сервером 

Состояние передается, хранится в тепе запроса. 

Обновление заметки о фильмах. 

```
РUТ /notes/films/ HTTP/1.1
Accept: application/json 
Accept-Encoding: gzip, deflate
Host: localhost:5000 

{ 
  "title": "Films", 
  "description": "Films to watch" 
} 
```

### Ресурсы 

---

Use path, not quегу 

```
/notes/films 
/api?type=notes&id=films 
```

---

Use plurals, not singles 

```
/notes/films
/note/films 
```

не жесткое правило, для единичного ресурса не надо 

---

Use only nouns, not чегЬб 

создание заметки 

```
РОSТ /notes/add
РОSТ /notes 
```

глагол -- НТТР-метод 

---

Avoid чегЫаде, ое plurals 

```
/notes
```

---

Use Iowercase 

---

Use nesting вложенные ресурсы 

```
/notes/films/comments 
```

---

### Действия
 
__GЕТ__

получает состояние ресурса в виде json, xml или html 

Не модифицирует ресурс 

```
6ЕТ /notes/fi1ms 
    /notes?limit=10 
```

Рекомендуемый ответ 

```
200 Ok 
404 
400 Bad request /notes?limit=muahahah 
```

__POST__ 

создаёт новый ресурс с начальным состоянием, когда мы не знаем его 10 

```
РОSТ /notes 

201 Created 
409 Conflict 
```

__PUT__ 

создаёт новый ресурс с начальным состоянием, когда мы знаем его 10 

```
РUТ /notes/fi1ms 
```

используется также для обновления состояния ресурса целиком 

```
200 Ok 
204 No content 
404 Not found
``` 

---

__DЕLЕТЕ__

удаление ресурса 

```
DELETE /notes/films 

200 Ok 
204 No content 
404 Not found 
```

__РАТСН__

метод для частичного обновления состояния существующего ресурса. 

---

## Рекомендация REST 

приложение должно предоставлять некоторую связность ресурсов друг с другом 

Пример 

```
POST /notes  
Accept:  
Аccept-Encoding:  
Ноя: localhost  

{ 
  "tit1e": "Fi1ms", 
  "description": "хуг" 
} 
```

```
НТТР/1.1 201 Created
Location: /notes/films
```

адрес, по которому расположен этот ресурс.

Вообще связность каждый делает как хочет. 

_Hypertext Application_ - общее решения для связывания ресурсов в рамках взаимодействия по REST. 


GЕТ, РUТ, ОЕЕЕТЕ - идемпотентны 

РОSТ, РАТСН - не идемпотентны 

__Версионирование__

При сломе обратной совместимости `api.github.com/v3/`

